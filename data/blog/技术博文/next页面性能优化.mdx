---
title: next 页面性能优化
date: '2023-12-25'
tags: ['通用','原创']
draft: false
summary: ""
---

<TOCInlineWithSticky toc={props.toc} />

## 添加 dns-prefetch、preconnect meta 标签

```tsx
<Head>
  <link rel="dns-prefetch" href="//example.com" />
  <link rel="preconnect" href="//example.com" />
</Head>
```

## 图片压缩

尽量使用 webp 格式图片和压缩图片

## 图片懒加载

```tsx
<Image loading="lazy" src={renderItem.img} alt="" fill  />
```

## [自部署 next 服务的自定义图片 loader 优化](https://nextjs.org/docs/app/api-reference/components/image#loader)

```tsx
'use client'

import React, { ComponentProps } from 'react';
import Image from 'next/image';

export const CustomLoaderImg = (props: ComponentProps<typeof Image>) => {
  return (
    <Image
      {...props}
      loader={({ src, width, quality }) => {
        // 确认一个可用的图片优化服务之后替换
        return `https://optimize-img.com?url=${src}?w=${width}&q=${quality || 75}`;
      }}
    />
  );
};
```